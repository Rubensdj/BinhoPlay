<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RH Specialist AI - Rubens Fernandes</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Great+Vibes&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        /* --- ESTÉTICA CORPORATIVA --- */
        body { font-family: 'Inter', sans-serif; background: #eef2f6; height: 100vh; display: flex; overflow: hidden; }

        /* SIDEBAR (Configurações) */
        .sidebar {
            width: 300px; background: #111827; color: white;
            display: flex; flex-direction: column; padding: 20px;
            border-right: 1px solid #374151;
        }

        /* ÁREA DE CHAT */
        .main-chat {
            flex: 1; display: flex; flex-direction: column; background: white; position: relative;
        }

        .chat-history {
            flex: 1; overflow-y: auto; padding: 30px;
            background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 20px 20px; /* Efeito pontilhado sutil */
        }

        .input-area {
            padding: 20px; background: white; border-top: 1px solid #e5e7eb;
            display: flex; gap: 10px; align-items: center;
        }

        /* MENSAGENS */
        .msg {
            max-width: 80%; padding: 15px; border-radius: 12px; margin-bottom: 15px;
            line-height: 1.6; font-size: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            animation: fadeIn 0.3s ease;
        }
        .msg-ai {
            background: #f3f4f6; color: #1f2937; align-self: flex-start;
            border-left: 4px solid #2563eb; border-top-left-radius: 2px;
        }
        .msg-user {
            background: #2563eb; color: white; align-self: flex-end;
            border-top-right-radius: 2px;
        }
        
        /* ASSINATURA DIGITAL */
        .digital-signature {
            margin-top: auto; /* Empurra para o final da sidebar */
            padding: 20px; background: #1f2937; border-radius: 8px;
            border: 1px solid #374151; text-align: center;
        }
        .sig-font { font-family: 'Great Vibes', cursive; font-size: 28px; color: #60a5fa; margin-bottom: 5px; }
        .sig-badge { font-size: 10px; color: #9ca3af; text-transform: uppercase; letter-spacing: 1px; }
        .sig-hash { font-family: monospace; font-size: 9px; color: #4b5563; margin-top: 5px; }

        /* UTILS */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        
        /* Animação */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Markdown Style */
        .msg ul { list-style: disc; padding-left: 20px; margin: 10px 0; }
        .msg strong { font-weight: 700; }
        .msg h3 { font-size: 16px; font-weight: bold; margin-top: 10px; color: #2563eb; }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="flex items-center gap-3 mb-8">
            <div class="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-white">
                <i class="fas fa-brain"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg">RH Specialist</h1>
                <p class="text-xs text-green-400">● Sistema Online</p>
            </div>
        </div>

        <div class="mb-6">
            <label class="text-xs font-bold text-gray-500 uppercase mb-2 block">Modo de Atuação</label>
            <select id="aiMode" class="w-full bg-gray-800 text-white text-sm p-2 rounded border border-gray-700 focus:outline-none focus:border-blue-500">
                <option value="analista">Analista de Recrutamento (Padrão)</option>
                <option value="critico">Crítico Rigoroso (Acha erros)</option>
                <option value="copywriter">Copywriter (Melhora textos)</option>
                <option value="coach">Coach de Carreira (Dá conselhos)</option>
            </select>
        </div>

        <div class="mb-6">
            <label class="text-xs font-bold text-gray-500 uppercase mb-2 block">Ações Rápidas</label>
            <button onclick="sendQuickAction('Revisar gramática e tom')" class="w-full text-left text-sm text-gray-300 hover:text-white hover:bg-gray-800 p-2 rounded mb-1"><i class="fas fa-check-double mr-2 text-blue-500"></i> Revisar Texto</button>
            <button onclick="sendQuickAction('Adaptar para ATS (Robôs)')" class="w-full text-left text-sm text-gray-300 hover:text-white hover:bg-gray-800 p-2 rounded mb-1"><i class="fas fa-robot mr-2 text-purple-500"></i> Otimizar para ATS</button>
            <button onclick="sendQuickAction('Sugerir melhorias de impacto')" class="w-full text-left text-sm text-gray-300 hover:text-white hover:bg-gray-800 p-2 rounded"><i class="fas fa-magic mr-2 text-yellow-500"></i> Melhorar Impacto</button>
        </div>

        <div class="digital-signature">
            <div class="flex justify-center mb-2">
                <i class="fas fa-file-signature text-blue-500 text-xl"></i>
            </div>
            <div class="sig-badge">Assinado Digitalmente por</div>
            <div class="sig-font">Rubens Pereira Fernandes</div>
            <div class="sig-badge text-green-500 mt-1"><i class="fas fa-check-circle"></i> Autenticado</div>
            <div class="sig-hash" id="sigHash">Hash: a1b2-c3d4-e5f6-7890</div>
            <div class="text-[9px] text-gray-500 mt-1" id="sigDate">Data: ...</div>
        </div>
    </div>

    <div class="main-chat">
        <div class="p-4 border-b border-gray-200 bg-white flex justify-between items-center shadow-sm z-10">
            <div>
                <h2 class="font-bold text-gray-800">Consultoria Direta</h2>
                <p class="text-xs text-gray-500">O Gemini analisará o texto enviado abaixo.</p>
            </div>
            <button onclick="clearChat()" class="text-xs text-red-500 hover:text-red-700 font-bold">Limpar Conversa</button>
        </div>

        <div id="chatHistory" class="chat-history custom-scrollbar flex flex-col">
            <div class="msg msg-ai">
                Olá, Rubens! Sou sua IA Especialista em RH. <br><br>
                Cole aqui o texto do currículo, uma descrição de experiência ou um resumo, e eu farei a análise técnica. Também posso aceitar suas sugestões para moldar minha análise.
            </div>
        </div>

        <div class="input-area">
            <textarea id="userInput" rows="2" placeholder="Cole o texto do currículo ou dê uma instrução..." class="flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"></textarea>
            <button onclick="sendMessage()" class="bg-blue-600 hover:bg-blue-700 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg transition transform hover:scale-105">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <script>
        // --- CONFIGURAÇÃO ---
        const API_KEY = "AIzaSyCt2utmXB26ptkJ05OT4a1wR50LPZ_YEvY";
        
        // Histórico da conversa para manter o contexto
        let conversationHistory = [];

        // --- INICIALIZAÇÃO DA ASSINATURA ---
        function updateSignature() {
            const now = new Date();
            const dateStr = now.toLocaleDateString('pt-BR') + ' às ' + now.toLocaleTimeString('pt-BR');
            // Gera um hash aleatório para parecer "criptografado"
            const hash = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
            
            document.getElementById('sigDate').innerText = "Data: " + dateStr;
            document.getElementById('sigHash').innerText = "Token: " + hash.toUpperCase();
        }
        setInterval(updateSignature, 60000); // Atualiza a cada minuto
        updateSignature();

        // --- LÓGICA DO CHAT ---
        async function sendMessage() {
            const input = document.getElementById('userInput');
            const text = input.value.trim();
            if (!text) return;

            // Adiciona mensagem do usuário na tela
            appendMessage('user', text);
            input.value = '';

            // Prepara o contexto para a IA
            const mode = document.getElementById('aiMode').value;
            let systemInstruction = "";

            if(conversationHistory.length === 0) {
                // Primeira instrução do sistema (Persona)
                systemInstruction = `
                    ATENÇÃO: Você é um Especialista Sênior em RH e Recrutamento.
                    Seu nome no sistema é Gemini RH.
                    O proprietário do sistema é Rubens Pereira Fernandes.
                    
                    SEU OBJETIVO:
                    1. Analisar textos de currículo colados pelo usuário.
                    2. Corrigir gramática e ortografia implacavelmente.
                    3. Sugerir melhorias baseadas em palavras-chave (SEO/ATS).
                    4. Se o usuário der uma ordem (ex: "seja mais formal"), obedeça imediatamente.
                    
                    MODO ATUAL: ${mode.toUpperCase()}.
                    Seja profissional, direto e use formatação Markdown (negrito, listas).
                `;
            }

            // Monta o prompt
            let prompt = text;
            if(systemInstruction) prompt = systemInstruction + "\n\nUsuário diz: " + text;

            // Mostra "Digitando..."
            const loadingId = appendMessage('ai', '<i class="fas fa-circle-notch fa-spin"></i> Analisando...');

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [
                            { role: "user", parts: [{ text: prompt }] }
                            // Nota: Para manter histórico real, precisaríamos reenviar as mensagens anteriores,
                            // mas para economizar tokens neste exemplo, enviamos o contexto atualizado.
                        ]
                    })
                });

                const data = await response.json();
                const aiText = data.candidates[0].content.parts[0].text;

                // Remove o loading e adiciona a resposta real
                document.getElementById(loadingId).remove();
                appendMessage('ai', aiText);

                // Salva no histórico (memória simples)
                conversationHistory.push({ role: "user", text: text });
                conversationHistory.push({ role: "model", text: aiText });

            } catch (error) {
                document.getElementById(loadingId).innerHTML = "Erro de conexão. Verifique a chave API.";
            }
        }

        function sendQuickAction(action) {
            document.getElementById('userInput').value = `Por favor, realize a seguinte ação no texto anterior ou neste contexto: ${action}`;
            sendMessage();
        }

        function appendMessage(sender, text) {
            const history = document.getElementById('chatHistory');
            const div = document.createElement('div');
            const id = 'msg-' + Date.now();
            div.id = id;
            div.className = `msg msg-${sender}`;
            
            // Se for IA, processa Markdown, se for usuário, texto puro (segurança)
            if (sender === 'ai') {
                div.innerHTML = marked.parse(text);
                // Adiciona uma mini assinatura do Rubens em cada resposta da IA para reforçar a marca
                if(!text.includes('fa-spin')) { // Só adiciona se não for loading
                    div.innerHTML += `<div style="margin-top:10px; border-top:1px solid #ccc; padding-top:5px; font-size:10px; color:#666; text-align:right;">Validado por Rubens Pereira Fernandes</div>`;
                }
            } else {
                div.innerText = text;
            }

            history.appendChild(div);
            history.scrollTop = history.scrollHeight;
            return id;
        }

        function clearChat() {
            document.getElementById('chatHistory').innerHTML = '<div class="msg msg-ai">Chat limpo. Aguardando novo currículo.</div>';
            conversationHistory = [];
        }

        // Enviar com Enter
        document.getElementById('userInput').addEventListener('keypress', function (e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

    </script>
</body>
</html>
