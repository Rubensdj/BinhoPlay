<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Currículo Budapest com IA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        :root {
            --primary: #2c3e50;
            --accent: #e74c3c;
            --bg-light: #f4f7f6;
            --glass: rgba(255, 255, 255, 0.95);
        }

        * { box-sizing: border-box; font-family: 'Roboto', sans-serif; }
        
        body {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- TELA 1: FORMULÁRIO --- */
        #input-screen {
            background: var(--glass);
            width: 100%;
            max-width: 800px;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 50px;
        }

        h1 { color: var(--primary); text-align: center; margin-bottom: 30px; }
        h2 { color: var(--primary); font-size: 18px; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 30px; margin-bottom: 20px;}

        .form-row { display: flex; gap: 20px; margin-bottom: 15px; }
        .form-group { flex: 1; display: flex; flex-direction: column; }
        
        label { font-weight: 500; margin-bottom: 5px; color: #555; font-size: 14px; }
        input, textarea {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: #fff;
            transition: 0.3s;
        }
        input:focus, textarea:focus { border-color: var(--accent); outline: none; }
        textarea { resize: vertical; min-height: 100px; }

        /* Botão Mágico IA */
        .ai-btn {
            background: linear-gradient(45deg, #8e44ad, #3498db);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            align-self: flex-end;
            margin-top: -30px; /* Sobrepõe levemente */
            margin-right: 10px;
            margin-bottom: 10px;
            z-index: 10;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: 0.3s;
        }
        .ai-btn:hover { transform: scale(1.05); box-shadow: 0 0 10px rgba(142, 68, 173, 0.5); }

        /* Switch Foto */
        .switch-container { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; background: #eee; padding: 10px; border-radius: 8px; }
        .toggle-switch { position: relative; display: inline-block; width: 50px; height: 24px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc; transition: .4s; border-radius: 34px;
        }
        .slider:before {
            position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px;
            background-color: white; transition: .4s; border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(26px); }

        /* Botão Gerar */
        .btn-generate {
            width: 100%;
            padding: 15px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 30px;
            transition: 0.3s;
        }
        .btn-generate:hover { background: #c0392b; }

        /* --- TELA 2: CURRÍCULO (Preview) --- */
        #cv-screen { display: none; width: 100%; align-items: center; flex-direction: column; }
        
        .toolbar {
            background: white;
            padding: 15px;
            border-radius: 50px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .tool-btn {
            background: var(--primary); color: white; border: none; padding: 10px 20px;
            border-radius: 25px; cursor: pointer; font-weight: bold; display: flex; align-items: center; gap: 8px;
        }
        .tool-btn.edit { background: #f39c12; }
        .tool-btn:hover { opacity: 0.9; }

        /* Modelo Budapest CSS (Reutilizado e Ajustado) */
        .page {
            background: white;
            width: 210mm;
            min-height: 297mm;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            display: flex;
        }

        .sidebar { background: var(--primary); color: white; width: 32%; padding: 30px 20px; text-align: center; }
        .main-content { width: 68%; padding: 40px; color: #333; }
        
        .sidebar.no-photo-mode { width: 25%; text-align: left; }
        .sidebar.no-photo-mode .photo-container { display: none; }
        .main-content.no-photo-mode { width: 75%; }

        .photo-container {
            width: 150px; height: 150px; border-radius: 50%; background: #ccc;
            margin: 0 auto 30px; overflow: hidden; border: 4px solid rgba(255,255,255,0.2);
        }
        .photo-container img { width: 100%; height: 100%; object-fit: cover; }

        .sidebar h3 { font-size: 14px; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 5px; margin-bottom: 15px; text-transform: uppercase; }
        .contact-item { font-size: 13px; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; text-align: left; word-break: break-all;}
        .contact-item i { width: 15px; color: var(--accent); }

        .header-name { font-size: 36px; font-weight: 700; color: var(--primary); text-transform: uppercase; line-height: 1; }
        .header-title { font-size: 18px; color: var(--accent); margin-bottom: 30px; margin-top: 5px;}
        
        .section-title { 
            color: var(--primary); font-weight: 700; text-transform: uppercase; 
            border-bottom: 2px solid #eee; padding-bottom: 5px; margin: 25px 0 15px 0; display: flex; align-items: center; gap: 10px;
        }
        .section-title i { color: var(--accent); }

        .job-item { margin-bottom: 20px; }
        .job-header { display: flex; justify-content: space-between; font-weight: 700; }
        .job-date { color: var(--accent); font-size: 12px; }
        .job-company { font-style: italic; color: #666; font-size: 14px; margin-bottom: 5px; }
        .job-desc { font-size: 14px; line-height: 1.5; white-space: pre-line; }

        /* Loading Overlay */
        #ai-loading {
            display: none; position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.7); z-index: 2000; justify-content: center; align-items: center; color: white; flex-direction: column;
        }

    </style>
</head>
<body>

    <div id="ai-loading">
        <i class="fas fa-magic fa-3x fa-spin" style="margin-bottom: 15px; color: #e74c3c;"></i>
        <h3>A Inteligência Artificial está melhorando seu texto...</h3>
    </div>

    <div id="input-screen">
        <h1><i class="fas fa-file-contract"></i> Criar Currículo Profissional</h1>
        
        <div class="switch-container">
            <label class="toggle-switch">
                <input type="checkbox" id="include-photo" checked onchange="togglePhotoInput()">
                <span class="slider"></span>
            </label>
            <span>Incluir Foto no Currículo</span>
        </div>

        <form id="cv-form" onsubmit="event.preventDefault(); generateCV();">
            
            <div id="photo-upload-group" class="form-row">
                <div class="form-group">
                    <label>Sua Foto (Opcional)</label>
                    <input type="file" id="photo-input" accept="image/*">
                </div>
            </div>

            <h2>Dados Pessoais</h2>
            <div class="form-row">
                <div class="form-group"><label>Nome Completo</label><input type="text" id="inp-name" placeholder="Ex: João Silva" required></div>
                <div class="form-group"><label>Cargo/Título</label><input type="text" id="inp-title" placeholder="Ex: Gestor Comercial" required></div>
            </div>
            <div class="form-row">
                <div class="form-group"><label>E-mail</label><input type="email" id="inp-email" placeholder="email@exemplo.com"></div>
                <div class="form-group"><label>Telefone</label><input type="text" id="inp-phone" placeholder="(00) 00000-0000"></div>
            </div>
            <div class="form-row">
                <div class="form-group"><label>Cidade/Estado</label><input type="text" id="inp-location" placeholder="São Paulo, SP"></div>
                <div class="form-group"><label>LinkedIn (URL)</label><input type="text" id="inp-linkedin" placeholder="linkedin.com/in/voce"></div>
            </div>

            <h2>Resumo Profissional</h2>
            <div class="form-group">
                <button type="button" class="ai-btn" onclick="improveText('inp-summary')"><i class="fas fa-wand-magic-sparkles"></i> Melhorar com IA</button>
                <textarea id="inp-summary" placeholder="Escreva um breve resumo sobre você... Ex: Tenho experiência em vendas e gosto de liderar equipes."></textarea>
            </div>

            <h2>Experiência Recente</h2>
            <div class="form-row">
                <div class="form-group"><label>Empresa</label><input type="text" id="inp-exp1-company"></div>
                <div class="form-group"><label>Cargo</label><input type="text" id="inp-exp1-role"></div>
                <div class="form-group"><label>Período</label><input type="text" id="inp-exp1-date" placeholder="2020 - Atual"></div>
            </div>
            <div class="form-group">
                <button type="button" class="ai-btn" onclick="improveText('inp-exp1-desc')"><i class="fas fa-wand-magic-sparkles"></i> Melhorar com IA</button>
                <textarea id="inp-exp1-desc" placeholder="Descreva suas atividades e conquistas..."></textarea>
            </div>

            <h2>Formação Acadêmica</h2>
            <div class="form-row">
                <div class="form-group"><label>Instituição</label><input type="text" id="inp-edu-school"></div>
                <div class="form-group"><label>Curso</label><input type="text" id="inp-edu-course"></div>
                <div class="form-group"><label>Ano Conclusão</label><input type="text" id="inp-edu-date"></div>
            </div>

            <h2>Habilidades (Separe por vírgula)</h2>
            <div class="form-group">
                <input type="text" id="inp-skills" placeholder="Ex: Liderança, Excel Avançado, Inglês Fluente, HTML">
            </div>

            <button class="btn-generate">Gerar Currículo <i class="fas fa-arrow-right"></i></button>
        </form>
    </div>

    <div id="cv-screen">
        <div class="toolbar" data-html2canvas-ignore="true">
            <button class="tool-btn edit" onclick="editCV()"><i class="fas fa-pen"></i> Voltar e Editar</button>
            <button class="tool-btn" onclick="downloadPDF()"><i class="fas fa-download"></i> Baixar PDF</button>
        </div>

        <div class="page" id="cv-document">
            <aside class="sidebar" id="cv-sidebar">
                <div class="photo-container" id="cv-photo-container">
                    <img id="cv-photo" src="" alt="">
                </div>

                <div class="sidebar-section">
                    <h3>Contato</h3>
                    <div class="contact-item"><i class="fas fa-phone-alt"></i> <span id="cv-phone"></span></div>
                    <div class="contact-item"><i class="fas fa-envelope"></i> <span id="cv-email"></span></div>
                    <div class="contact-item"><i class="fas fa-map-marker-alt"></i> <span id="cv-location"></span></div>
                    <div class="contact-item"><i class="fab fa-linkedin"></i> <span id="cv-linkedin"></span></div>
                </div>

                <div class="sidebar-section">
                    <h3>Habilidades</h3>
                    <div id="cv-skills-list">
                        </div>
                </div>
            </aside>

            <main class="main-content" id="cv-main">
                <header>
                    <div class="header-name" id="cv-name">NOME</div>
                    <div class="header-title" id="cv-title">CARGO</div>
                </header>

                <section>
                    <div class="section-title"><i class="fas fa-user"></i> Resumo</div>
                    <p id="cv-summary">Resumo aqui...</p>
                </section>

                <section>
                    <div class="section-title"><i class="fas fa-briefcase"></i> Experiência</div>
                    <div class="job-item">
                        <div class="job-header">
                            <span id="cv-exp1-role">Cargo</span>
                            <span class="job-date" id="cv-exp1-date">Data</span>
                        </div>
                        <div class="job-company" id="cv-exp1-company">Empresa</div>
                        <div class="job-desc" id="cv-exp1-desc">Descrição</div>
                    </div>
                </section>

                <section>
                    <div class="section-title"><i class="fas fa-graduation-cap"></i> Formação</div>
                    <div class="job-item">
                        <div class="job-header">
                            <span id="cv-edu-course">Curso</span>
                            <span class="job-date" id="cv-edu-date">Ano</span>
                        </div>
                        <div class="job-company" id="cv-edu-school">Instituição</div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <script>
        // --- 1. Lógica da "IA Simulada" ---
        // Como não temos um servidor backend aqui, usamos um dicionário de substituição
        // para simular a melhoria do texto, tornando-o mais formal.
        const aiDictionary = {
            "fiz": "executei",
            "vendi": "realizei a comercialização de",
            "ajudei": "colaborei ativamente com",
            "cuidei": "gerenciei",
            "usei": "utilizei ferramentas como",
            "trabalhei": "atuei profissionalmente",
            "gosto de": "tenho forte aptidão para",
            "mandei": "enviei e supervisionei",
            "falei": "apresentei e negociei",
            "venda": "estratégias de vendas",
            "equipe": "equipes multidisciplinares",
            "problemas": "soluções para desafios complexos"
        };

        function improveText(fieldId) {
            const field = document.getElementById(fieldId);
            let text = field.value;

            if (text.trim() === "") {
                alert("Por favor, digite algo primeiro para a IA melhorar.");
                return;
            }

            // Mostra animação de carregamento
            document.getElementById('ai-loading').style.display = 'flex';

            setTimeout(() => {
                // Simula "inteligência": substitui palavras simples por corporativas
                let newText = text;
                for (const [simple, fancy] of Object.entries(aiDictionary)) {
                    // Regex para substituir a palavra inteira, case insensitive
                    const regex = new RegExp(`\\b${simple}\\b`, 'gi');
                    newText = newText.replace(regex, fancy);
                }

                // Se o texto for muito curto, adiciona um preenchimento genérico
                if (text.length < 20) {
                    newText += ". Foco em resultados consistentes e otimização de processos.";
                }

                // Capitaliza a primeira letra
                newText = newText.charAt(0).toUpperCase() + newText.slice(1);

                field.value = newText;
                
                document.getElementById('ai-loading').style.display = 'none';
            }, 1500); // 1.5 segundos de delay para "pensar"
        }

        // --- 2. Controle da Foto ---
        function togglePhotoInput() {
            const isChecked = document.getElementById('include-photo').checked;
            const inputGroup = document.getElementById('photo-upload-group');
            inputGroup.style.display = isChecked ? 'flex' : 'none';
        }

        // --- 3. Gerar Currículo ---
        function generateCV() {
            // Pegar valores
            document.getElementById('cv-name').innerText = document.getElementById('inp-name').value;
            document.getElementById('cv-title').innerText = document.getElementById('inp-title').value;
            document.getElementById('cv-email').innerText = document.getElementById('inp-email').value;
            document.getElementById('cv-phone').innerText = document.getElementById('inp-phone').value;
            document.getElementById('cv-location').innerText = document.getElementById('inp-location').value;
            document.getElementById('cv-linkedin').innerText = document.getElementById('inp-linkedin').value;
            document.getElementById('cv-summary').innerText = document.getElementById('inp-summary').value;

            // Experiência
            document.getElementById('cv-exp1-company').innerText = document.getElementById('inp-exp1-company').value;
            document.getElementById('cv-exp1-role').innerText = document.getElementById('inp-exp1-role').value;
            document.getElementById('cv-exp1-date').innerText = document.getElementById('inp-exp1-date').value;
            document.getElementById('cv-exp1-desc').innerText = document.getElementById('inp-exp1-desc').value;

            // Educação
            document.getElementById('cv-edu-school').innerText = document.getElementById('inp-edu-school').value;
            document.getElementById('cv-edu-course').innerText = document.getElementById('inp-edu-course').value;
            document.getElementById('cv-edu-date').innerText = document.getElementById('inp-edu-date').value;

            // Skills
            const skillsInput = document.getElementById('inp-skills').value;
            const skillsContainer = document.getElementById('cv-skills-list');
            skillsContainer.innerHTML = ''; // Limpar
            if(skillsInput) {
                const skillsArray = skillsInput.split(',');
                skillsArray.forEach(skill => {
                    const div = document.createElement('div');
                    div.className = 'contact-item'; // Reutilizando estilo
                    div.innerText = '• ' + skill.trim();
                    div.style.borderBottom = "1px solid rgba(255,255,255,0.1)";
                    div.style.padding = "5px 0";
                    skillsContainer.appendChild(div);
                });
            }

            // Lidar com a Foto
            const hasPhoto = document.getElementById('include-photo').checked;
            const sidebar = document.getElementById('cv-sidebar');
            const mainContent = document.getElementById('cv-main');
            const photoImg = document.getElementById('cv-photo');
            const photoInput = document.getElementById('photo-input');

            if (hasPhoto) {
                sidebar.classList.remove('no-photo-mode');
                mainContent.classList.remove('no-photo-mode');
                
                if (photoInput.files && photoInput.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) { photoImg.src = e.target.result; }
                    reader.readAsDataURL(photoInput.files[0]);
                }
            } else {
                sidebar.classList.add('no-photo-mode');
                mainContent.classList.add('no-photo-mode');
            }

            // Trocar telas
            document.getElementById('input-screen').style.display = 'none';
            document.getElementById('cv-screen').style.display = 'flex';
            window.scrollTo(0,0);
        }

        // --- 4. Voltar para Editar ---
        function editCV() {
            document.getElementById('cv-screen').style.display = 'none';
            document.getElementById('input-screen').style.display = 'block';
            window.scrollTo(0,0);
        }

        // --- 5. Baixar PDF ---
        function downloadPDF() {
            const element = document.getElementById('cv-document');
            const opt = {
                margin: 0,
                filename: 'meu-curriculo-budapest.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            html2pdf().set(opt).from(element).save();
        }
    </script>
</body>
</html>
