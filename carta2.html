<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Criador Profissional com IA - Rubens Fernandes</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        /* --- CORE --- */
        body { background: #cbd5e1; font-family: 'Inter', sans-serif; height: 100vh; margin: 0; overflow: hidden; }
        
        /* TELA DE LOGIN */
        #lockScreen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #0f172a; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: white; transition: opacity 0.5s;
        }

        /* LAYOUT PRINCIPAL (2 COLUNAS) */
        .app-container { display: flex; height: 100vh; }

        /* LADO ESQUERDO: CONTROLES (Editor + IA) */
        .control-panel {
            width: 400px; background: white; border-right: 1px solid #94a3b8;
            display: flex; flex-direction: column; z-index: 20;
            box-shadow: 5px 0 15px rgba(0,0,0,0.1);
        }

        /* Abas do Painel */
        .tabs { display: flex; background: #f1f5f9; border-bottom: 1px solid #cbd5e1; }
        .tab-btn {
            flex: 1; padding: 15px; text-align: center; font-weight: 600; font-size: 13px;
            color: #64748b; cursor: pointer; transition: 0.2s; border-bottom: 3px solid transparent;
        }
        .tab-btn:hover { background: #e2e8f0; }
        .tab-btn.active { color: #2563eb; border-bottom-color: #2563eb; background: white; }

        .panel-content { flex: 1; overflow-y: auto; padding: 20px; display: none; }
        .panel-content.active { display: block; }

        /* Inputs */
        .input-group { margin-bottom: 15px; }
        .input-label { font-size: 11px; font-weight: 800; color: #475569; text-transform: uppercase; margin-bottom: 5px; display: flex; justify-content: space-between; }
        .field { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 14px; background: #f8fafc; }
        .field:focus { border-color: #2563eb; background: white; outline: none; }

        /* Bot√£o M√°gico IA */
        .magic-btn {
            font-size: 10px; background: #8b5cf6; color: white; padding: 2px 8px; border-radius: 10px;
            cursor: pointer; display: flex; align-items: center; gap: 3px; border: none;
        }
        .magic-btn:hover { background: #7c3aed; }

        /* LADO DIREITO: O PAPEL (PREVIEW) */
        .preview-area {
            flex: 1; background: #64748b; display: flex; justify-content: center; align-items: flex-start;
            overflow-y: auto; padding: 40px; position: relative;
        }

        .a4-paper {
            width: 210mm; min-height: 297mm; background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            display: flex; position: relative;
            /* Layout Interno do Curr√≠culo */
        }

        .cv-left { width: 32%; background: #1e293b; color: white; padding: 30px 20px; text-align: center; }
        .cv-right { width: 68%; padding: 40px 30px; color: #334155; }

        /* Elementos CV */
        .photo-frame { width: 120px; height: 120px; border-radius: 50%; border: 4px solid white; margin: 0 auto 20px; overflow: hidden; background: #334155; }
        .photo-frame img { width: 100%; height: 100%; object-fit: cover; }
        
        .cv-name { font-size: 26pt; font-weight: 800; text-transform: uppercase; line-height: 1; color: #0f172a; margin: 0; }
        .cv-role { font-size: 12pt; color: #2563eb; font-weight: 600; text-transform: uppercase; margin-bottom: 25px; }
        
        .section-title { font-size: 12pt; font-weight: 700; text-transform: uppercase; border-bottom: 2px solid #cbd5e1; margin: 20px 0 10px; padding-bottom: 5px; color: #0f172a; }
        .side-title { font-size: 10pt; font-weight: 700; text-transform: uppercase; border-bottom: 1px solid rgba(255,255,255,0.2); margin: 20px 0 10px; padding-bottom: 5px; color: #94a3b8; text-align: left; }
        
        .contact-row { display: flex; align-items: center; gap: 10px; font-size: 9pt; margin-bottom: 8px; text-align: left; word-break: break-all; }
        .exp-item { margin-bottom: 15px; }
        .exp-role { font-weight: 700; font-size: 11pt; color: #1e293b; }
        .exp-desc { font-size: 10pt; text-align: justify; line-height: 1.4; color: #475569; }

        /* Chat Flutuante (Dentro da aba IA) */
        .chat-box { height: 400px; overflow-y: auto; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .msg { padding: 10px; border-radius: 8px; font-size: 13px; max-width: 90%; }
        .ai-msg { background: #e0e7ff; color: #1e1b4b; align-self: flex-start; }
        .user-msg { background: #2563eb; color: white; align-self: flex-end; }

        /* RESPONSIVIDADE MOBILE */
        @media (max-width: 1024px) {
            .app-container { flex-direction: column; }
            .control-panel { width: 100%; height: 50%; order: 2; }
            .preview-area { height: 50%; order: 1; padding: 10px; align-items: center; }
            .a4-paper { transform: scale(0.45); transform-origin: center; margin: 0; }
        }

        /* IMPRESS√ÉO */
        @media print {
            .control-panel, #lockScreen { display: none !important; }
            .preview-area { padding: 0; background: white; display: block; }
            .a4-paper { box-shadow: none; margin: 0; width: 100%; height: 100%; transform: none; }
            @page { margin: 0; size: A4; }
        }
    </style>
</head>
<body>

<div id="lockScreen">
    <i class="fas fa-lock text-5xl mb-4 text-blue-500"></i>
    <h2 class="text-xl font-bold mb-2">Sistema RH Seguro</h2>
    <p class="text-sm text-gray-400 mb-4">Autenticado para: Rubens Fernandes</p>
    <div class="flex gap-2">
        <input type="password" id="passInput" placeholder="Senha (1234)" class="p-2 rounded text-black text-center w-32">
        <button onclick="login()" class="bg-blue-600 px-4 py-2 rounded font-bold hover:bg-blue-700">Entrar</button>
    </div>
    <p id="errorMsg" class="text-red-500 text-xs mt-2 h-4"></p>
</div>

<div class="app-container">
    
    <div class="control-panel">
        <div class="tabs">
            <div class="tab-btn active" onclick="setTab('editor')"><i class="fas fa-pen"></i> DADOS (Editar)</div>
            <div class="tab-btn" onclick="setTab('ai')"><i class="fas fa-robot"></i> CONSULTORA IA</div>
        </div>

        <div id="tab-editor" class="panel-content active custom-scrollbar">
            <div class="bg-blue-50 border border-blue-200 p-3 rounded mb-4">
                <h3 class="text-xs font-bold text-blue-800 uppercase mb-2">A√ß√µes R√°pidas</h3>
                <div class="flex gap-2">
                    <button onclick="window.print()" class="bg-green-600 text-white text-xs font-bold px-3 py-2 rounded hover:bg-green-700 flex-1">
                        <i class="fas fa-print"></i> Baixar PDF
                    </button>
                    <button onclick="analyzeResume()" class="bg-purple-600 text-white text-xs font-bold px-3 py-2 rounded hover:bg-purple-700 flex-1">
                        <i class="fas fa-star"></i> Analisar com IA
                    </button>
                </div>
            </div>

            <div class="input-group">
                <div class="input-label">
                    <span>Foto de Perfil</span>
                    <input type="checkbox" id="checkPhoto" checked onchange="update()">
                </div>
                <input type="file" id="photoInput" onchange="loadPhoto(event)" class="text-xs">
            </div>

            <div class="input-group">
                <div class="input-label">Nome Completo</div>
                <input type="text" id="inName" class="field" value="Maria Marleide Ramalho" oninput="update()">
            </div>
            <div class="input-group">
                <div class="input-label">Cargo / Objetivo <button class="magic-btn" onclick="ask('role')">‚ú® Sugerir</button></div>
                <input type="text" id="inRole" class="field" value="Jovem Aprendiz" oninput="update()">
            </div>

            <div class="flex gap-2">
                <div class="input-group flex-1">
                    <div class="input-label">Telefone</div>
                    <input type="text" id="inPhone" class="field" value="(88) 8831-4122" oninput="update()">
                </div>
                <div class="input-group flex-1">
                    <div class="input-label">Email</div>
                    <input type="text" id="inEmail" class="field" value="ccontato138@gmail.com" oninput="update()">
                </div>
            </div>
            <div class="input-group">
                <div class="input-label">Endere√ßo</div>
                <input type="text" id="inLoc" class="field" value="Cidade Brasileira - CE" oninput="update()">
            </div>

            <div class="input-group">
                <div class="input-label">Resumo <button class="magic-btn" onclick="ask('summary')">‚ú® Melhorar</button></div>
                <textarea id="inSummary" rows="4" class="field" oninput="update()">Busco a primeira oportunidade de emprego, visando desenvolver habilidades profissionais e contribuir com dedica√ß√£o para o crescimento da empresa.</textarea>
            </div>

            <div class="input-group">
                <div class="input-label">Experi√™ncia 1 <button class="magic-btn" onclick="ask('exp')">‚ú® Enriquecer</button></div>
                <input type="text" id="inExpTitle" class="field mb-1" value="Vendedora - Dorinha Confec√ß√µes" placeholder="Cargo - Empresa" oninput="update()">
                <textarea id="inExpDesc" rows="3" class="field" placeholder="O que fazia?" oninput="update()">Atendimento ao cliente e vendas.</textarea>
            </div>

            <div class="input-group">
                <div class="input-label">Experi√™ncia 2 (Opcional)</div>
                <input type="text" id="inExpTitle2" class="field mb-1" value="Aut√¥noma / Servi√ßos Gerais" oninput="update()">
                <textarea id="inExpDesc2" rows="3" class="field" oninput="update()">Comerciante e cuidadora de crian√ßas.</textarea>
            </div>

            <div class="input-group">
                <div class="input-label">Escolaridade</div>
                <input type="text" id="inSchool" class="field" value="Ensino M√©dio - Cursando 3¬∫ Ano" oninput="update()">
            </div>

            <div class="input-group">
                <div class="input-label">Habilidades <button class="magic-btn" onclick="ask('skills')">‚ú® Listar</button></div>
                <textarea id="inSkills" rows="4" class="field" oninput="update()">Comunica√ß√£o
Pontualidade
Trabalho em Equipe</textarea>
            </div>
        </div>

        <div id="tab-ai" class="panel-content custom-scrollbar">
            <div class="flex items-center gap-2 mb-4 p-2 bg-gray-100 rounded">
                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white"><i class="fas fa-robot"></i></div>
                <div>
                    <h3 class="font-bold text-sm">Gemini RH</h3>
                    <p class="text-[10px] text-gray-500">Chave Segura Ativada</p>
                </div>
            </div>

            <div id="chatBox" class="chat-box custom-scrollbar">
                <div class="msg ai-msg">
                    Ol√°! Sou sua consultora de RH. <br>
                    Estou monitorando o que voc√™ escreve. Clique nos bot√µes <b>‚ú®</b> no editor para eu ajudar, ou pe√ßa uma <b>An√°lise Completa</b> quando terminar.
                </div>
            </div>

            <div class="mt-3 flex gap-2">
                <input type="text" id="chatInput" placeholder="Fa√ßa uma pergunta..." class="field" onkeypress="if(event.key==='Enter') sendChat()">
                <button onclick="sendChat()" class="bg-blue-600 text-white px-3 rounded hover:bg-blue-700"><i class="fas fa-paper-plane"></i></button>
            </div>
            
            <button onclick="ask('courses')" class="w-full mt-4 bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 rounded text-xs flex justify-center items-center gap-2">
                <i class="fas fa-lightbulb"></i> Me indique cursos para minha √°rea
            </button>
        </div>
    </div>

    <div class="preview-area custom-scrollbar">
        <div class="a4-paper">
            
            <div class="cv-left">
                <div id="photoContainer" class="photo-frame"><img id="outImg" src=""></div>
                
                <div class="side-title">Contato</div>
                <div class="contact-row"><i class="fas fa-phone text-blue-400"></i> <span id="outPhone"></span></div>
                <div class="contact-row"><i class="fas fa-envelope text-blue-400"></i> <span id="outEmail"></span></div>
                <div class="contact-row"><i class="fas fa-map-marker-alt text-blue-400"></i> <span id="outLoc"></span></div>

                <div class="side-title">Educa√ß√£o</div>
                <div style="text-align: left; font-size: 0.9em; line-height: 1.4;" id="outSchool"></div>

                <div class="side-title">Compet√™ncias</div>
                <div id="outSkills" style="text-align: left; font-size: 0.9em; line-height: 1.6;"></div>
            </div>

            <div class="cv-right">
                <h1 class="cv-name" id="outName"></h1>
                <div class="cv-role" id="outRole"></div>

                <div class="section-title">Sobre Mim</div>
                <p class="cv-text" id="outSummary"></p>

                <div class="section-title">Experi√™ncia Profissional</div>
                
                <div class="exp-item">
                    <div class="exp-role" id="outExpTitle"></div>
                    <div class="exp-desc" id="outExpDesc"></div>
                </div>

                <div class="exp-item" id="exp2Box">
                    <div class="exp-role" id="outExpTitle2"></div>
                    <div class="exp-desc" id="outExpDesc2"></div>
                </div>
            </div>

        </div>
    </div>

</div>

<script>
    // --- SEGURAN√áA (Ofusca√ß√£o) ---
    const _0x1 = [65,73,122,97,83,121,67,116,50,117,116,109,88,66,50,54,112,116,107,74,48,53,79,84,52,97,49,119,82,53,48,76,80,90,95,89,69,118,89];
    const getKey = () => String.fromCharCode(..._0x1);

    // --- LOGIN ---
    function login() {
        if(document.getElementById('passInput').value === "1234") {
            document.getElementById('lockScreen').style.opacity = '0';
            setTimeout(() => document.getElementById('lockScreen').style.display = 'none', 500);
        } else {
            document.getElementById('errorMsg').innerText = "Senha Incorreta";
        }
    }

    // --- NAVEGA√á√ÉO ---
    function setTab(name) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.panel-content').forEach(p => p.classList.remove('active'));
        
        // Ativa a aba clicada
        event.currentTarget.classList.add('active');
        document.getElementById('tab-'+name).classList.add('active');
    }

    // --- UPDATE CV (Sincronia) ---
    function update() {
        setText('outName', 'inName'); setText('outRole', 'inRole');
        setText('outPhone', 'inPhone'); setText('outEmail', 'inEmail'); setText('outLoc', 'inLoc');
        setText('outSummary', 'inSummary'); setText('outSchool', 'inSchool');
        setText('outExpTitle', 'inExpTitle'); setText('outExpDesc', 'inExpDesc');
        
        // Exp 2
        const t2 = document.getElementById('inExpTitle2').value;
        if(t2) {
            document.getElementById('exp2Box').style.display = 'block';
            document.getElementById('outExpTitle2').innerText = t2;
            document.getElementById('outExpDesc2').innerText = document.getElementById('inExpDesc2').value;
        } else {
            document.getElementById('exp2Box').style.display = 'none';
        }

        // Skills
        const skills = document.getElementById('inSkills').value.split('\n');
        document.getElementById('outSkills').innerHTML = skills.map(s => s.trim() ? `<div>‚Ä¢ ${s}</div>` : '').join('');

        // Foto
        document.getElementById('photoContainer').style.display = document.getElementById('checkPhoto').checked ? 'block' : 'none';
    }
    function setText(o, i) { document.getElementById(o).innerText = document.getElementById(i).value; }
    
    function loadPhoto(e) {
        const r = new FileReader();
        r.onload = ev => document.getElementById('outImg').src = ev.target.result;
        if(e.target.files[0]) r.readAsDataURL(e.target.files[0]);
    }

    // --- IA GEMINI ---
    function addMsg(cls, txt) {
        const d = document.createElement('div');
        d.className = `msg ${cls}`;
        d.innerHTML = marked.parse(txt);
        document.getElementById('chatBox').appendChild(d);
        document.getElementById('chatBox').scrollTop = 9999;
    }

    async function callGemini(prompt) {
        setTab('ai'); // For√ßa ir para aba IA
        addMsg('ai-msg', '‚è≥ Analisando...');
        
        try {
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${getKey()}`, {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            const json = await res.json();
            document.querySelector('.ai-msg:last-child').remove(); // Remove loading
            return json.candidates[0].content.parts[0].text;
        } catch(e) { return "Erro de conex√£o."; }
    }

    async function improve(type) {
        const role = document.getElementById('inRole').value;
        const sum = document.getElementById('inSummary').value;
        let p = "";
        
        if(type==='role') p = `Sugira 3 cargos profissionais para quem digitou "${role}". Lista simples.`;
        if(type==='summary') p = `Reescreva este resumo para RH, foque em resultados: "${sum}". Cargo: ${role}.`;
        if(type==='exp') p = `Melhore esta descri√ß√£o de experi√™ncia: "${document.getElementById('inExpDesc').value}".`;
        if(type==='skills') p = `Liste 5 skills essenciais para ${role}.`;
        if(type==='courses') p = `Indique 3 cursos online (com nome real) para a √°rea de ${role}.`;

        const txt = await callGemini(p);
        addMsg('ai-msg', txt);
    }

    async function analyzeResume() {
        const allText = `Nome: ${document.getElementById('inName').value}. Cargo: ${document.getElementById('inRole').value}. Resumo: ${document.getElementById('inSummary').value}. Experi√™ncia: ${document.getElementById('inExpDesc').value}.`;
        const p = `Atue como Recrutador S√™nior. Analise este curr√≠culo: "${allText}". D√™ uma nota de 0 a 10 e liste 3 pontos espec√≠ficos para melhorar. Seja direto.`;
        const txt = await callGemini(p);
        addMsg('ai-msg', `üìä **An√°lise do Curr√≠culo:**\n\n${txt}`);
    }

    async function sendChat() {
        const t = document.getElementById('chatInput').value;
        if(!t) return;
        addMsg('user-msg', t);
        document.getElementById('chatInput').value = "";
        const r = await callGemini(`Contexto: Usu√°rio fazendo curr√≠culo para ${document.getElementById('inRole').value}. Pergunta: ${t}`);
        addMsg('ai-msg', r);
    }

    // Start
    window.onload = update;
</script>

</body>
</html>
