<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Currículo Budapest Premium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Condensed:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        :root {
            /* Cores do Tema Budapest */
            --sidebar-bg: #373d48; /* Cinza Escuro/Azulado */
            --sidebar-txt: #ffffff;
            --main-bg: #ffffff;
            --text-primary: #2c3e50;
            --accent-color: #c0392b; /* Vermelho Clássico Budapest */
            
            /* Cores da Interface de Edição */
            --ui-bg: #f0f2f5;
            --ui-panel: #ffffff;
            --ui-primary: #2980b9;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background: var(--ui-bg); font-family: 'Roboto Condensed', sans-serif; padding-bottom: 50px; }

        /* --- UI: FORMULÁRIO (NÃO SAI NO PDF) --- */
        .editor-container {
            max-width: 900px; margin: 30px auto; background: var(--ui-panel);
            padding: 40px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .editor-header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #eee; padding-bottom: 20px; }
        .editor-header h1 { color: var(--text-primary); font-family: 'Montserrat', sans-serif; }
        
        .form-section { margin-bottom: 25px; background: #f9f9f9; padding: 20px; border-radius: 8px; border-left: 4px solid var(--ui-primary); }
        .form-section h3 { margin-bottom: 15px; color: var(--ui-primary); display: flex; align-items: center; gap: 10px; }
        
        .row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px; }
        .full { grid-column: span 2; }
        
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 14px; color: #555; }
        input, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; }
        input:focus, textarea:focus { border-color: var(--ui-primary); outline: none; box-shadow: 0 0 0 3px rgba(41, 128, 185, 0.1); }
        textarea { resize: vertical; min-height: 80px; }

        /* Botões */
        .btn-group { display: flex; gap: 15px; margin-top: 30px; justify-content: center; }
        .btn { padding: 15px 30px; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; font-size: 16px; display: flex; align-items: center; gap: 10px; transition: 0.3s; }
        .btn-gen { background: #27ae60; color: white; }
        .btn-gen:hover { background: #219150; transform: translateY(-2px); }
        .btn-ai { background: linear-gradient(45deg, #8e44ad, #9b59b6); color: white; padding: 5px 15px; font-size: 12px; border-radius: 4px; margin-top: 5px; cursor: pointer; border: none;}

        /* Toggle Switch */
        .toggle-wrapper { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; background: #eee; padding: 10px; border-radius: 5px; width: fit-content; }
        .switch { position: relative; display: inline-block; width: 40px; height: 24px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--ui-primary); }
        input:checked + .slider:before { transform: translateX(16px); }

        /* --- TELA 2: VISUALIZAÇÃO (PAPEL A4 REAL) --- */
        #preview-screen { display: none; flex-direction: column; align-items: center; padding-top: 20px; }
        
        .toolbar { position: sticky; top: 20px; background: #333; color: white; padding: 10px 25px; border-radius: 30px; display: flex; gap: 20px; z-index: 1000; box-shadow: 0 5px 15px rgba(0,0,0,0.3); margin-bottom: 30px; }
        .toolbar button { background: none; border: none; color: white; cursor: pointer; font-weight: bold; font-size: 14px; display: flex; align-items: center; gap: 8px; }
        .toolbar button:hover { color: #ccc; }

        /* O CURRÍCULO BUDAPEST (A4) */
        .cv-page {
            width: 210mm;
            min-height: 297mm;
            background: white;
            box-shadow: 0 0 25px rgba(0,0,0,0.15);
            display: flex;
            position: relative;
            overflow: hidden; /* Corta o que passar da folha */
        }

        /* Coluna Esquerda (Sidebar) */
        .cv-sidebar {
            width: 35%; /* Proporção clássica */
            background-color: var(--sidebar-bg);
            color: var(--sidebar-txt);
            padding: 40px 25px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .cv-sidebar.no-photo { justify-content: flex-start; text-align: left; padding-top: 60px; }
        .cv-sidebar.no-photo .photo-box { display: none; }

        .photo-box {
            width: 160px; height: 160px;
            border-radius: 50%;
            border: 5px solid rgba(255,255,255,0.15);
            overflow: hidden;
            margin-bottom: 40px;
            background: #555;
        }
        .photo-box img { width: 100%; height: 100%; object-fit: cover; }

        .side-block { width: 100%; margin-bottom: 40px; text-align: left; }
        .side-title {
            text-transform: uppercase;
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 16px;
            letter-spacing: 2px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 10px;
            margin-bottom: 20px;
            color: #eee;
        }

        .contact-row { display: flex; align-items: center; gap: 12px; margin-bottom: 15px; font-size: 14px; font-weight: 300; }
        .contact-row i { width: 20px; text-align: center; color: var(--accent-color); }
        .contact-row span { word-break: break-all; }

        .skill-tag {
            display: inline-block;
            background: rgba(255,255,255,0.1);
            padding: 5px 10px;
            border-radius: 4px;
            margin: 0 5px 8px 0;
            font-size: 13px;
        }

        /* Coluna Direita (Conteúdo) */
        .cv-main {
            width: 65%;
            padding: 50px 40px;
            color: var(--text-primary);
        }

        header { margin-bottom: 40px; }
        .cv-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 42px;
            font-weight: 700;
            text-transform: uppercase;
            line-height: 1;
            color: var(--text-primary);
            margin-bottom: 10px;
        }
        .cv-role {
            font-size: 18px;
            color: var(--accent-color);
            text-transform: uppercase;
            letter-spacing: 3px;
            font-weight: 600;
        }

        .main-block { margin-bottom: 35px; }
        .main-title {
            display: flex; align-items: center; gap: 15px;
            font-family: 'Montserrat', sans-serif;
            font-size: 18px;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        .main-title i { color: var(--accent-color); font-size: 20px; }

        .summary-text { font-size: 14px; line-height: 1.6; color: #444; text-align: justify; }

        .job-entry { margin-bottom: 25px; page-break-inside: avoid; }
        .job-top { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 5px; }
        .job-title { font-weight: 700; font-size: 16px; color: #222; }
        .job-time { font-size: 13px; font-weight: 700; color: var(--accent-color); }
        .job-company { font-style: italic; color: #666; font-size: 14px; margin-bottom: 8px; font-family: 'Montserrat', sans-serif;}
        .job-desc { font-size: 14px; line-height: 1.5; color: #444; }

        /* Spinner IA */
        #ai-loader { display: none; color: var(--ui-primary); font-size: 14px; font-weight: bold; margin-left: 10px; }

        @media screen and (max-width: 768px) {
            .cv-page { width: 100%; height: auto; flex-direction: column; }
            .cv-sidebar, .cv-main { width: 100%; }
            .row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="editor-container" id="editor-screen">
        <div class="editor-header">
            <h1>Gerador Budapest Profissional</h1>
            <p>Preencha os dados para gerar o modelo clássico.</p>
        </div>

        <form id="form-cv" onsubmit="event.preventDefault(); generate();">
            
            <div class="toggle-wrapper">
                <span style="font-size: 14px; font-weight: bold;">Foto de Perfil</span>
                <label class="switch">
                    <input type="checkbox" id="has-photo" checked onchange="togglePhotoInput()">
                    <span class="slider"></span>
                </label>
            </div>
            
            <div id="photo-input-area" class="form-section">
                <h3><i class="fas fa-camera"></i> Foto</h3>
                <input type="file" id="inp-photo" accept="image/*">
            </div>

            <div class="form-section">
                <h3><i class="fas fa-user"></i> Informações Pessoais</h3>
                <div class="row">
                    <div><label>Nome Completo</label><input type="text" id="inp-name" placeholder="Ex: Roberto Almeida" required></div>
                    <div><label>Cargo Desejado</label><input type="text" id="inp-role" placeholder="Ex: Engenheiro Civil" required></div>
                </div>
                <div class="row">
                    <div><label>E-mail</label><input type="email" id="inp-email"></div>
                    <div><label>Telefone</label><input type="text" id="inp-phone"></div>
                </div>
                <div class="row">
                    <div class="full"><label>Endereço / Localização</label><input type="text" id="inp-addr" placeholder="São Paulo, SP"></div>
                </div>
            </div>

            <div class="form-section">
                <h3><i class="fas fa-align-left"></i> Resumo Profissional</h3>
                <textarea id="inp-summary" placeholder="Fale sobre sua carreira..."></textarea>
                <button type="button" class="btn-ai" onclick="runAI('inp-summary')"><i class="fas fa-magic"></i> Melhorar Texto (IA)</button>
                <span id="ai-loader"><i class="fas fa-spinner fa-spin"></i> Melhorando...</span>
            </div>

            <div class="form-section">
                <h3><i class="fas fa-briefcase"></i> Última Experiência</h3>
                <div class="row">
                    <div><label>Empresa</label><input type="text" id="inp-exp-comp"></div>
                    <div><label>Cargo</label><input type="text" id="inp-exp-role"></div>
                </div>
                <div class="row">
                    <div class="full"><label>Período</label><input type="text" id="inp-exp-time" placeholder="2020 - Atual"></div>
                </div>
                <div class="full">
                    <label>Descrição das Atividades</label>
                    <textarea id="inp-exp-desc"></textarea>
                    <button type="button" class="btn-ai" onclick="runAI('inp-exp-desc')"><i class="fas fa-magic"></i> Melhorar Texto</button>
                </div>
            </div>

            <div class="form-section">
                <h3><i class="fas fa-graduation-cap"></i> Formação</h3>
                <div class="row">
                    <div><label>Instituição</label><input type="text" id="inp-edu-school"></div>
                    <div><label>Curso</label><input type="text" id="inp-edu-course"></div>
                </div>
                <div class="row"><div class="full"><label>Ano de Conclusão</label><input type="text" id="inp-edu-year"></div></div>
            </div>

            <div class="form-section">
                <h3><i class="fas fa-star"></i> Habilidades (Separe por vírgula)</h3>
                <input type="text" id="inp-skills" placeholder="Gestão, Inglês, Excel...">
            </div>

            <div class="btn-group">
                <button class="btn btn-gen"><i class="fas fa-file-pdf"></i> Gerar Currículo</button>
            </div>
        </form>
    </div>

    <div id="preview-screen">
        <div class="toolbar" data-html2canvas-ignore="true">
            <button onclick="editMode()"><i class="fas fa-arrow-left"></i> Voltar / Editar</button>
            <span style="border-left:1px solid #777; height: 15px;"></span>
            <button onclick="savePDF()"><i class="fas fa-download"></i> Baixar PDF Final</button>
        </div>

        <div class="cv-page" id="cv-doc">
            <aside class="cv-sidebar" id="sidebar">
                <div class="photo-box">
                    <img id="out-photo" src="" alt="">
                </div>

                <div class="side-block">
                    <div class="side-title">Contato</div>
                    <div class="contact-row"><i class="fas fa-envelope"></i><span id="out-email"></span></div>
                    <div class="contact-row"><i class="fas fa-phone"></i><span id="out-phone"></span></div>
                    <div class="contact-row"><i class="fas fa-map-marker-alt"></i><span id="out-addr"></span></div>
                </div>

                <div class="side-block">
                    <div class="side-title">Competências</div>
                    <div id="out-skills"></div>
                </div>
            </aside>

            <main class="cv-main">
                <header>
                    <div class="cv-name" id="out-name">Nome Sobrenome</div>
                    <div class="cv-role" id="out-role">Cargo Profissional</div>
                </header>

                <section class="main-block">
                    <div class="main-title"><i class="fas fa-user"></i> Perfil</div>
                    <p class="summary-text" id="out-summary"></p>
                </section>

                <section class="main-block">
                    <div class="main-title"><i class="fas fa-briefcase"></i> Experiência</div>
                    <div class="job-entry">
                        <div class="job-top">
                            <span class="job-title" id="out-exp-role">Cargo</span>
                            <span class="job-time" id="out-exp-time">Data</span>
                        </div>
                        <div class="job-company" id="out-exp-comp">Empresa</div>
                        <p class="job-desc" id="out-exp-desc"></p>
                    </div>
                </section>

                <section class="main-block">
                    <div class="main-title"><i class="fas fa-graduation-cap"></i> Educação</div>
                    <div class="job-entry">
                        <div class="job-top">
                            <span class="job-title" id="out-edu-course">Curso</span>
                            <span class="job-time" id="out-edu-year">Ano</span>
                        </div>
                        <div class="job-company" id="out-edu-school">Instituição</div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <script>
        // --- 1. CONFIGURAÇÕES VISUAIS ---
        function togglePhotoInput() {
            const show = document.getElementById('has-photo').checked;
            document.getElementById('photo-input-area').style.display = show ? 'block' : 'none';
        }

        // --- 2. IA SIMULADA (MELHORAR TEXTO) ---
        const aiVocab = {
            "vendi": "gerenciei vendas e negociações de",
            "fiz": "desenvolvi e implementei",
            "ajudei": "colaborei estrategicamente com",
            "cuidei": "supervisionei a gestão de",
            "problemas": "soluções para desafios complexos",
            "coisas": "projetos e demandas",
            "usei": "utilizei ferramentas como"
        };

        function runAI(fieldId) {
            const el = document.getElementById(fieldId);
            const loader = document.getElementById('ai-loader');
            
            if(!el.value) return alert("Escreva algo primeiro!");
            
            loader.style.display = "inline-block";
            setTimeout(() => {
                let txt = el.value.toLowerCase();
                for (let [simple, fancy] of Object.entries(aiVocab)) {
                    txt = txt.replace(new RegExp(`\\b${simple}\\b`, 'g'), fancy);
                }
                el.value = txt.charAt(0).toUpperCase() + txt.slice(1);
                loader.style.display = "none";
            }, 1000);
        }

        // --- 3. GERADOR DO CURRÍCULO ---
        function generate() {
            // Mapeamento Campo -> Destino
            const map = {
                'inp-name': 'out-name', 'inp-role': 'out-role',
                'inp-email': 'out-email', 'inp-phone': 'out-phone', 'inp-addr': 'out-addr',
                'inp-summary': 'out-summary',
                'inp-exp-role': 'out-exp-role', 'inp-exp-comp': 'out-exp-comp',
                'inp-exp-time': 'out-exp-time', 'inp-exp-desc': 'out-exp-desc',
                'inp-edu-course': 'out-edu-course', 'inp-edu-school': 'out-edu-school',
                'inp-edu-year': 'out-edu-year'
            };

            for (let id in map) {
                const val = document.getElementById(id).value;
                document.getElementById(map[id]).innerText = val;
            }

            // Skills (Transformar em tags)
            const skillTxt = document.getElementById('inp-skills').value;
            const skillBox = document.getElementById('out-skills');
            skillBox.innerHTML = "";
            if(skillTxt) {
                skillTxt.split(',').forEach(s => {
                    if(s.trim()) {
                        skillBox.innerHTML += `<span class="skill-tag">${s.trim()}</span>`;
                    }
                });
            }

            // Foto
            const hasPhoto = document.getElementById('has-photo').checked;
            const sidebar = document.getElementById('sidebar');
            if(hasPhoto) {
                sidebar.classList.remove('no-photo');
                const file = document.getElementById('inp-photo').files[0];
                if(file) {
                    const reader = new FileReader();
                    reader.onload = e => document.getElementById('out-photo').src = e.target.result;
                    reader.readAsDataURL(file);
                }
            } else {
                sidebar.classList.add('no-photo');
            }

            // Trocar tela
            document.getElementById('editor-screen').style.display = 'none';
            document.getElementById('preview-screen').style.display = 'flex';
            window.scrollTo(0,0);
        }

        function editMode() {
            document.getElementById('preview-screen').style.display = 'none';
            document.getElementById('editor-screen').style.display = 'block';
            window.scrollTo(0,0);
        }

        // --- 4. EXPORTAR PDF (ALTA QUALIDADE) ---
        function savePDF() {
            const element = document.getElementById('cv-doc');
            const opt = {
                margin: 0,
                filename: 'Curriculo-Budapest.pdf',
                image: { type: 'jpeg', quality: 1 }, // Qualidade Máxima
                html2canvas: { 
                    scale: 2, // Aumenta resolução
                    useCORS: true, 
                    scrollY: 0
                },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            
            // Botão carregando
            const btn = document.querySelector('.toolbar button:last-child');
            const oldText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Gerando...';
            
            html2pdf().set(opt).from(element).save().then(() => {
                btn.innerHTML = oldText;
            });
        }
    </script>
</body>
</html>
